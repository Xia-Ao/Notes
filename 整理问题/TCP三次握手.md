## TCP三次握手的过程

先通俗的看一看有趣的图

![](/assets/tcp三次握手.png)这里在网上看到有人提出来，TCP握手，为什么是三次，一次行不行，两次行不行，三次就一定可以了了吗，这些个问题我解释不了，都是网上看到的，这里贴出来

> 在Google Groups的TopLanguage中看到一帖讨论TCP“三次握手”觉得很有意思。贴主提出“TCP建立连接为什么是三次握手？”的问题，在众多回复中，有一条回复写道：“这个问题的本质是, **信道不可靠**, 但是通信双发需要就某个问题达成一致. 而要解决这个问题, 无论你在消息中包含什么信息, 三次通信是理论上的最小值. 所以三次握手不是TCP本身的要求, 而是为了满足"在不可靠信道上可靠地传输信息"这一需求所导致的. 请注意这里的本质需求,信道不可靠, 数据传输要可靠. 三次达到了, 那后面你想接着握手也好, 发数据也好, 跟进行可靠信息传输的需求就没关系了. 因此,如果信道是可靠的, 即无论什么时候发出消息, 对方一定能收到, 或者你不关心是否要保证对方收到你的消息, 那就能像UDP那样直接发送消息就可以了.”。这可视为对“三次握手”目的的另一种解答思路。
>
> 在谢希仁著《计算机网络》第四版中讲“三次握手”的目的是“**为了防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误**”。
>
> 在另一部经典的《计算机网络》一书中讲“三次握手”的目的是为了解决“网络中存在延迟的重复分组”的问题。

言归正传，关于TCP三次握手过程![](/assets/816045-20161105220355065-482198403.png){:height="50%" width="50%"}
位码即tcp标志位，有6种标示：**SYN**\(synchronous建立联机\) 、**ACK**\(acknowledgement 确认\) 、**PSH**\(push传送\)、** FIN**\(finish结束\) 、**RST**\(reset重置\) 、**URG**\(urgent紧急\)、**Sequence number**\(顺序号码\) 、**Acknowledge number**\(确认号码\)。

**三次握手：**

　　第一次握手：客户端发送syn包（syn=x）的数据包到服务器，并进入SYN\_SEND状态，等待服务器确认；

　　第二次握手：服务器收到syn包，必须确认客户的SYN（ack=x+1），同时自己也发送一个SYN包（syn=y），即SYN+ACK包，此时服务器进入SYN\_RECV状态；

　　第三次握手：客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK\(ack=y+1\)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。

　　握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP连接都将被一直保持下去。





